$(function(){

	var DEFAULTS = {
			backgroundColor: '#b3cef6',
			progressColor: '#4b86db',
			percent: 0,
			duration: 1000
	};

	$(window).scroll(function(e){
        parallax();
    });

    $('.showmore_one').showMore({
		speedDown: 300,
        speedUp: 300,
        height: '0px',
        showText: 'Show more',
        hideText: 'Show less'
	});

	$('.part2-content').css('display','none');
    
    function parallax(){
        var scrolled = $(window).scrollTop();
        $('.bg').css('top',-(scrolled*0.1)+'px');
        $('.bg2').css('top',-(scrolled*0.05)+'px');
        $('.bg3').css('top',-(scrolled*0.01)+'px');
    }

    $(".part2").click(function() { 
    	$(".part2-content").css('display','block');
    	$(".part1-content").css('display','none');
    	
	});
	
	$(".part1").click(function() { 
    	$(".part2-content").css('display','none');
    	$(".part1-content").css('display','block');

	});

	$('.progress-bar').each(function () {
			
			var $target  = $(this);

			var opts = {
			backgroundColor: $target.data('color') ? $target.data('color').split(',')[0] : DEFAULTS.backgroundColor,
			progressColor: $target.data('color') ? $target.data('color').split(',')[1] : DEFAULTS.progressColor,
			percent: $target.data('percent') ? $target.data('percent') : DEFAULTS.percent,
			duration: $target.data('duration') ? $target.data('duration') : DEFAULTS.duration
			};
			console.log(opts);
			
			$target.append('<div class="background"></div><div class="rotate"></div><div class="left"></div><div class="right"></div><div class=""><span>' + opts.percent + '%</span></div>');
	
			$target.find('.background').css('background-color', opts.backgroundColor);
			$target.find('.left').css('background-color', opts.backgroundColor);
			$target.find('.rotate').css('background-color', opts.progressColor);
			$target.find('.right').css('background-color', opts.progressColor);
	
			var $rotate = $target.find('.rotate');
			setTimeout(function () {	
				$rotate.css({
					'transition': 'transform ' + opts.duration + 'ms linear',
					'transform': 'rotate(' + opts.percent * 3.6 + 'deg)'
				});
			},1);		

			if (opts.percent > 50) {
				var animationRight = 'toggle ' + (opts.duration / opts.percent * 50) + 'ms step-end';
				var animationLeft = 'toggle ' + (opts.duration / opts.percent * 50) + 'ms step-start';  
				$target.find('.right').css({
					animation: animationRight,
					opacity: 1
				});
				$target.find('.left').css({
					animation: animationLeft,
					opacity: 0
				});
			}
			
		});

});
(function(a) {
    a.fn.showMore = function(b) {
        var c = {
            speedDown: 300,
            speedUp: 300,
            height: "265px",
            showText: "Show",
            hideText: "Hide"
        };
        var b = a.extend(c, b);
        return this.each(function() {
            var e = a(this),
                d = e.height();
            if (d > parseInt(b.height)) {
                e.wrapInner('<div class="showmore_content" />');
                e.find(".showmore_content").css("height", b.height);
                e.append('<div class="showmore_trigger"><span class="more">' + b.showText + '</span><span class="less" style="display:none;">' + b.hideText + "</span></div>");
                e.find(".showmore_trigger").on("click", ".more", function() {
                    a(this).hide();
                    a(this).next().show();
                    a(this).parent().prev().animate({
                        height: d
                    }, b.speedDown)
                });
                e.find(".showmore_trigger").on("click", ".less", function() {
                    a(this).hide();
                    a(this).prev().show();
                    a(this).parent().prev().animate({
                        height: b.height
                    }, b.speedUp)
                })
            }
        })
    }
})(jQuery);